(function(c, k, a, l) {
    a.swipebox = function(g, m) {
        var n = {
                useCSS: !0,
                hideBarsDelay: 3E3
            },
            f = this,
            e = a(g),
            p = a(g.selector),
            h = k.createTouch !== l || "ontouchstart" in c || "onmsgesturechange" in c || navigator.msMaxTouchPoints,
            q = !!c.SVGSVGElement;
        f.settings = {};
        f.init = function() {
            f.settings = a.extend({}, n, m);
            p.click(function(b) {
                b.preventDefault();
                b.stopPropagation();
                index = e.index(a(this));
                r.init(index)
            })
        };
        var r = {
            init: function(b) {
                this.build();
                this.openSlide(b);
                this.openImg(b);
                this.preloadImg(b + 1);
                this.preloadImg(b - 1)
            },
            build: function() {
                var b =
                    this;
                a("body").append('<div id="swipebox-overlay">\t\t\t\t\t<div id="swipebox-slider"></div>\t\t\t\t\t<div id="swipebox-caption"></div>\t\t\t\t\t<div id="swipebox-action">\t\t\t\t\t\t<a id="swipebox-close"></a>\t\t\t\t\t\t<a id="swipebox-prev"></a>\t\t\t\t\t\t<a id="swipebox-next"></a>\t\t\t\t\t</div>\t\t\t</div>');
                b.doCssTrans() && (a("#swipebox-slider").css({
                    "-webkit-transition": "left 0.4s ease",
                    "-moz-transition": "left 0.4s ease",
                    "-o-transition": "left 0.4s ease",
                    "-khtml-transition": "left 0.4s ease",
                    transition: "left 0.4s ease"
                }), a("#swipebox-overlay").css({
                    "-webkit-transition": "opacity 1s ease",
                    "-moz-transition": "opacity 1s ease",
                    "-o-transition": "opacity 1s ease",
                    "-khtml-transition": "opacity 1s ease",
                    transition: "opacity 1s ease"
                }), a("#swipebox-action, #swipebox-caption").css({
                    "-webkit-transition": "0.5s",
                    "-moz-transition": "0.5s",
                    "-o-transition": "0.5s",
                    "-khtml-transition": "0.5s",
                    transition: "0.5s"
                }));
                if (q) {
                    var d = a("#swipebox-action #swipebox-close").css("background-image");
                    d = d.replace("png", "svg");
                    a("#swipebox-action #swipebox-prev,#swipebox-action #swipebox-next,#swipebox-action #swipebox-close").css({
                        "background-image": d
                    })
                }
                e.each(function() {
                    a("#swipebox-slider").append('<div class="slide"></div>')
                });
                b.setDim();
                b.actions();
                b.keyboard();
                b.gesture();
                b.animBars();
                a(c).resize(function() {
                    b.setDim()
                }).resize()
            },
            setDim: function() {
                var b = {
                    width: a(c).width(),
                    height: c.innerHeight ? c.innerHeight : a(c).height()
                };
                a("#swipebox-overlay").css(b)
            },
            supportTransition: function() {
                for (var b = "transition WebkitTransition MozTransition OTransition msTransition KhtmlTransition".split(" "),
                        a = 0; a < b.length; a++)
                    if (k.createElement("div").style[b[a]] !== l) return b[a];
                return !1
            },
            doCssTrans: function() {
                if (f.settings.useCSS && this.supportTransition()) return !0
            },
            gesture: function() {
                if (h) {
                    var b = this,
                        d = null,
                        c, e = {},
                        f = a("#swipebox-caption, #swipebox-action");
                    f.addClass("visible-bars");
                    b.setTimeout();
                    a("body").bind("touchstart", function(b) {
                        a(this).addClass("touching");
                        e = b.originalEvent.targetTouches[0];
                        c = b.originalEvent.targetTouches[0].pageX;
                        a(".touching").bind("touchmove", function(b) {
                            b.preventDefault();
                            b.stopPropagation();
                            e = b.originalEvent.targetTouches[0]
                        });
                        return !1
                    }).bind("touchend", function(g) {
                        g.preventDefault();
                        g.stopPropagation();
                        d = e.pageX - c;
                        10 <= d ? b.getPrev() : -10 >= d ? b.getNext() : f.hasClass("visible-bars") ? (b.clearTimeout(), b.hideBars()) : (b.showBars(), b.setTimeout());
                        a(".touching").off("touchmove").removeClass("touching")
                    })
                }
            },
            setTimeout: function() {
                if (0 < f.settings.hideBarsDelay) {
                    var b = this;
                    b.clearTimeout();
                    b.timeout = c.setTimeout(function() {
                        b.hideBars()
                    }, f.settings.hideBarsDelay)
                }
            },
            clearTimeout: function() {
                c.clearTimeout(this.timeout);
                this.timeout = null
            },
            showBars: function() {
                var b = a("#swipebox-caption, #swipebox-action");
                this.doCssTrans() ? b.addClass("visible-bars") : (a("#swipebox-caption").animate({
                    top: 0
                }, 500), a("#swipebox-action").animate({
                    bottom: 0
                }, 500), setTimeout(function() {
                    b.addClass("visible-bars")
                }, 1E3))
            },
            hideBars: function() {
                var b = a("#swipebox-caption, #swipebox-action");
                this.doCssTrans() ? b.removeClass("visible-bars") : (a("#swipebox-caption").animate({
                    top: "-50px"
                }, 500), a("#swipebox-action").animate({
                    bottom: "-50px"
                }, 500), setTimeout(function() {
                        b.removeClass("visible-bars")
                    },
                    1E3))
            },
            animBars: function() {
                var b = this,
                    d = a("#swipebox-caption, #swipebox-action");
                h || (d.addClass("visible-bars"), b.setTimeout(), a("#swipebox-slider").click(function(a) {
                    d.hasClass("visible-bars") || (b.showBars(), b.setTimeout())
                }), a("#swipebox-action").hover(function() {
                    b.showBars();
                    d.addClass("force-visible-bars");
                    b.clearTimeout()
                }, function() {
                    d.removeClass("force-visible-bars");
                    b.setTimeout()
                }))
            },
            keyboard: function() {
                if (!h) {
                    var b = this;
                    a(c).bind("keyup", function(a) {
                        a.preventDefault();
                        a.stopPropagation();
                        37 == a.keyCode ? b.getPrev() : 39 == a.keyCode ? b.getNext() : 27 == a.keyCode && b.closeSlide()
                    })
                }
            },
            actions: function() {
                var b = this;
                2 > e.length ? a("#swipebox-prev, #swipebox-next").hide() : (a("#swipebox-prev").bind("click touchend", function(a) {
                    a.preventDefault();
                    a.stopPropagation();
                    b.getPrev();
                    b.setTimeout()
                }), a("#swipebox-next").bind("click touchend", function(a) {
                    a.preventDefault();
                    a.stopPropagation();
                    b.getNext();
                    b.setTimeout()
                }));
                a("#swipebox-close").bind("click touchstart", function(a) {
                    b.closeSlide()
                })
            },
            setSlide: function(b) {
                var d =
                    a("#swipebox-slider");
                this.doCssTrans() ? d.css({
                    left: 100 * -b + "%"
                }) : d.animate({
                    left: 100 * -b + "%"
                });
                a("#swipebox-slider .slide").removeClass("current");
                a("#swipebox-slider .slide").eq(b).addClass("current");
                this.setTitle(b);
                a("#swipebox-prev, #swipebox-next").removeClass("disabled");
                0 == b ? a("#swipebox-prev").addClass("disabled") : b == e.length - 1 && a("#swipebox-next").addClass("disabled")
            },
            openSlide: function(b) {
                a("#swipebox-overlay").show().stop().animate({
                    opacity: 1
                }, "slow").addClass("visible");
                setTimeout(function() {
                        a("body").addClass("swipebox-overflow-hidden")
                    },
                    1500);
                this.setSlide(b)
            },
            preloadImg: function(b) {
                var a = this;
                setTimeout(function() {
                    a.openImg(b)
                }, 1E3)
            },
            openImg: function(b) {
                if (0 > b || b >= e.length) return !1;
                this.loadImg(e.eq(b).attr("href"), function() {
                    a("#swipebox-slider .slide").eq(b).html(this)
                })
            },
            setTitle: function(b) {
                e.eq(b).attr("title") && a("#swipebox-caption").empty().append(e.eq(b).attr("title"))
            },
            loadImg: function(b, d) {
                var c = a("<img>").on("load", function() {
                    d.call(c)
                });
                c.attr("src", b)
            },
            getNext: function() {
                index = a("#swipebox-slider .slide").index(a("#swipebox-slider .slide.current"));
                index + 1 < e.length ? (index++, this.setSlide(index), this.preloadImg(index + 1)) : (a("#swipebox-slider").addClass("rightSpring"), setTimeout(function() {
                    a("#swipebox-slider").removeClass("rightSpring")
                }, 500))
            },
            getPrev: function() {
                index = a("#swipebox-slider .slide").index(a("#swipebox-slider .slide.current"));
                0 < index ? (index--, this.setSlide(index), this.preloadImg(index - 1)) : (a("#swipebox-slider").addClass("leftSpring"), setTimeout(function() {
                    a("#swipebox-slider").removeClass("leftSpring")
                }, 500))
            },
            closeSlide: function() {
                var b =
                    this;
                a("body").removeClass("swipebox-overflow-hidden");
                a("#swipebox-overlay").animate({
                    opacity: 0
                }, "fast");
                setTimeout(function() {
                    a("#swipebox-overlay").removeClass("visible");
                    b.destroy()
                }, 1E3)
            },
            destroy: function() {
                a(c).unbind("keyup");
                a(c).unbind("resize");
                a("body").unbind();
                a("#swipebox-slider").unbind();
                a("#swipebox-overlay").remove();
                e.removeData("_swipebox")
            }
        };
        f.init()
    };
    a.fn.swipebox = function(c) {
        a.data(this, "_swipebox") || (c = new a.swipebox(this, c), this.data("_swipebox", c))
    }
})(window, document, jQuery);